<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css" type="text/css">
    <script src="script.js"></script>
    <title>Events</title>
</head>
<body>
    <!--Task1-->
    <ul id="tree">
        <li class="element">
            <span class="text">This PC</span>
            <ul class="inner">
                <li class="element">
                    <span class="text">Local Disk (C:)</span>
                    <ul class="inner">
                        <li class="element"><span class="text">Program Files</span></li>
                        <li class="element"><span class="text">Users</span></li>
                        <li class="element"><span class="text">Windows</span></li>
                    </ul>
                </li>
                <li class="element">
                    <span class="text">Local Disk (D:)</span>
                    <ul class="inner">
                        <li class="element"><span class="text">Folder 1</span></li>
                        <li class="element"><span class="text">Folder 2</span></li>
                        <li class="element"><span class="text">Folder 3</span></li>
                    </ul>
                </li>
                <li class="element">
                    <span class="text">Local Disk (E:)</span>
                    <ul class="inner">
                        <li class="element"><span class="text">Folder 1</span></li>
                        <li class="element"><span class="text">Folder 2</span></li>
                        <li class="element">
                        <span class="text">Folder 3</span>
                        <!--Добали еще чтоб проверить вложеность-->
                        <ul class="inner">
                            <li class="element"><span class="text">Program Files</span></li>
                            <li class="element"><span class="text">Users</span></li>
                            <li class="element"><span class="text">Windows</span></li>
                        </ul>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>

    
<ul id="bookList">
    <li>Книга 1</li>
    <li>Книга 2</li>
    <li>Книга 3</li>
    <li>Книга 4</li>
    <li>Книга 5</li>
  </ul>
  
    

<script>
        firstTask();
         let books = document.getElementById('bookList').getElementsByTagName('li');
            let previousClickedIndex = -1;
            const selectedIndices = new Set();

            for (let i = 0; i < books.length; i++) {
                books[i].addEventListener('click', function (event) {
                    if (!event.ctrlKey && !event.shiftKey) {
                        clearSelection();
                    }

                    if (event.ctrlKey) {
                        console.log("ctrl")
                        toggleSelection(i);
                    } else if (event.shiftKey && previousClickedIndex !== -1) {
                        console.log("shift")
                        selectRange(previousClickedIndex, i);
                    } else {
                        console.log("default click")
                        clearSelection();
                        console.log("clear")
                        previousClickedIndex = i;
                        books[i].classList.add('selected');
                    }
                });
            }

            function clearSelection() {
                for (const index of selectedIndices) {
                    books[index].classList.remove('selected');
                }
                selectedIndices.clear();
            }

            function toggleSelection(index) {
                if (selectedIndices.has(index)) {
                    books[index].classList.remove('selected');
                    selectedIndices.delete(index);
                } else {
                    books[index].classList.add('selected');
                    selectedIndices.add(index);
                }
            }

            function selectRange(start, end) {
                const startIndex = Math.min(start, end);
                const endIndex = Math.max(start, end);
                for (let i = startIndex; i <= endIndex; i++) {
                    books[i].classList.add('selected');
                    selectedIndices.add(i);
                }
            }
</script>
</body>
</html>